# Dependency Security Audit for Music Track Manager

**Дата**: 13.06.2025

## Загальний огляд залежностей

У проєкті навмисно використано **мінімальну кількість залежностей** — це зроблено для зменшення розміру бандлу та зменшення залежності від сторонніх бібліотек.
На сьогодні в проєкті: 8 dependencies (продакшн) та 17 devDependencies (тільки для розробки), що на мою думку, оптимально для невеликого SPA застосунку, як Music Track Manager.

## 1. Повний аудит залежностей

### Використані інструменти:

- npm audit
- GitHub Dependabot Advanced Security
- Ручна перевірка пакетів через:

  - npmjs.com
    - кількість завантажент на тиждень
    - останнє оновлення
    - автор пакету
  - GitHub репозиторії
    - співвідношення open/closed issues
    - кількість GitHub Stars

### 1.1. Продакшн-залежності

Ручна перевірка залежностей показала високу активність підтримки та надійність пакетів. Жодних відомих **продакшн**-вразливостей не виявила.

| Пакет              | npm завантажень/тиждень | ⭐ GitHub Stars | Підтримка                | Останнє оновлення  | Відомі вразливості | Примітки                              |
| ------------------ | ----------------------- | --------------- | ------------------------ | ------------------ | ------------------ | ------------------------------------- |
| vue                | ~6 293 471              | ~50 500         | ✅ Активна               | 16 днів тому       | Жодних             | Основний фронтенд-фреймворк           |
| vue-router         | ~3 694 840              | ~4 300          | ✅ Активна               | 2 місяці тому      | Жодних             | Офіційний роутинг                     |
| pinia              | ~1 979 752              | ~14 000         | ✅ Активна               | 9 днів тому        | Жодних             | State manager для Vue                 |
| zod                | ~31 111 258             | ~38 500         | ✅ Активна               | сьогодні(13.06.25) | Жодних             | Для валідації даних                   |
| neverthrow         | ~665 258                | ~5 200          | Мінімальна               | 4 місяці тому      | Жодних             | Обробник реквестів замість try/catch  |
| wavesurfer.js      | ~293 963                | ~9 400          | ⚠ Помірна               | 1 місяць тому      | Жодних             | Відображення waveform аудіо           |
| @mobily/ts-belt    | ~129 621                | ~1 200          | Стабільна, але неактивна | 2 роки тому        | Жодних             | utility library for FP in TypeScript. |
| vue-toastification | ~131 707                | ~3 300          | ⚠ Помірна               | 3 роки тому        | Жодних             | Для toast-повідомлень                 |

P.S. В перспективі розглядаю заміну `vue-toastification` через відсутність оновлень.

### 1.2. Dev-залежності

| Пакет                            | Завантажень/тиждень | ⭐ GitHub Stars | Підтримка  | Останнє оновлення    | Відомі вразливості               | Примітки                                 |
| -------------------------------- | ------------------- | --------------- | ---------- | -------------------- | -------------------------------- | ---------------------------------------- |
| vite                             | ~27 635 998         | ~15 800         | ✅ Активна | 1 міс. тому          | ⚠ vite@6.3.1–6.3.3 → виправлено | Білдер / dev сервер                      |
| @vitejs/plugin-vue               | ~3 080 763          | 582             | ✅ Активна | 8 днів тому          | Жодних                           | Плагін для Vite під Vue                  |
| @vue/tsconfig                    | ~794 275            | 335             | ✅ Активна | 7 міс. тому          | Жодних                           | TS-конфіг для Vue                        |
| vue-tsc                          | ~2 195 005          | ~6 200          | ✅ Активна | 6 днів тому          | Жодних                           | Перевірка типів .vue файлів              |
| typescript                       | ~84 641 116         | ~105 000        | ✅ Активна | 2 дні тому           | Жодних                           | TS-компілятор                            |
| eslint                           | ~59 035 195         | ~26 000         | ✅ Активна | сьогодні(13.06.25)   | Жодних                           | Статичний аналіз коду                    |
| eslint-plugin-vue                | ~3 900 548          | ~4 500          | ✅ Активна | 8 днів тому          | Жодних                           | Lint для .vue-файлів                     |
| @typescript-eslint/parser        | ~49 949 824         | ~15 800         | ✅ Активна | 6 днів тому          | Жодних                           | Парсер для ESLint + TS                   |
| @typescript-eslint/eslint-plugin | ~46 961 970         | ~15 800         | ✅ Активна | 6 днів тому          | Жодних                           | ESLint правила для TypeScript            |
| typescript-eslint                | ~11 646 234         | ~13 000         | ✅ Активна | 4 днів тому          | Жодних                           | Об'єднаний пакет (peer)                  |
| @vue/eslint-config-typescript    | ~1 225 279          | 160             | ✅ Активна | 3 міс. тому          | Жодних                           | Preset конфіг ESLint+TS для Vue          |
| vue-eslint-parser                | ~4 968 368          | 475             | ✅ Активна | 2 міс. тому          | Жодних                           | Парсер шаблонів Vue                      |
| husky                            | ~16 480 702         | ~33 700         | ✅ Активна | 7 місяців тому       | Жодних                           | Git hooks (наприклад lint перед комітом) |
| lint-staged                      | ~12 839 488         | ~13 900         | ✅ Активна | 18 днів тому         | Жодних                           | Прогон скриптів над зміненими файлами    |
| prettier                         | ~53 015 002         | ~50 600         | ✅ Активна | 3 місяців тому       | Жодних                           | Форматування коду                        |
| globals                          | ~137 479 683        | 484             | ✅ Активна | 19 днів тому         | Жодних                           | Глобальні змінні для ESLint              |
| @types/node                      | ~150 177 768        | ~49 900         | ✅ Активна | постійно, 2 дні тому | Жодних                           | Типи для Node.js API                     |

Жодних активних вразливостей не виявлено. Єдина знайдена проблема — у `brace-expansion` (низький пріоритет, вирішена).

## 2. Усунуті вразливості

### Оновлення `vite`

Dependabot повідомив про вразливість у `vite@6.3.3`:

- **Проблема**: `server.fs.deny` можна обійти через `/.`
- **Рішення**: оновлено до `vite@^6.3.4`

### Dev-only вразливість

Після виконання:

```bash
npm audit
```

- Знайдено 1 low severity проблему у `brace-expansion` (CWE-400: ReDoS)
- Залежність використовується лише в `eslint` (тільки під час розробки)
- Вирішено локально через:

```bash
npm audit fix
```

## 3. Zero-day вразливості

    ❗ Zero-day вразливість — це вразливість, про яку стало відомо до того, як вона була виправлена, і яка ще не має публічного патчу.

Не можна гарантувати повну відсутність zero-day вразливостей, однак:

- Всі залежності пройшли перевірку через:

  - npm audit

  - GitHub Dependabot Advanced Security

- Всі виявлені вразливості усунуті

- Всі бібліотеки активні, з великою спільнотою та історією підтримки

Жодної підтвердженої zero-day вразливості у використаних продакшн-залежностях не виявлено.

## 4 XSS-захисти, реалізовані у проєкті

Проєкт дотримується принципу мінімізації XSS-ризиків на рівні як реалізації, так і налаштувань середовища:

- **SVG-файли не використовувались** — зменшує ризик XSS через SVG payload.
- **`v-html` не застосовувався** — відсутній ризик XSS через динамічний HTML або DOM-based інʼєкції.
- **Інлайнові скрипти й стилі** — відсутні

## 5. Content Security Policy (CSP)

Хоча на поточному етапі проєкт ще не деплойється, вже можна закласти основу для безпечного production-середовища:

- **Запровадити Content-Security-Policy-Report-Only** через `<meta>`-тег або HTTP-заголовок у режимі тестування — це дозволить побачити потенційні порушення політики без фактичного блокування контенту.

```
 <meta
  http-equiv="Content-Security-Policy-Report-Only"
  content="default-src 'self'; script-src 'self'; style-src 'self' ; font-src 'none'; object-src 'none'; base-uri 'none'; form-action 'self'"
  report-to="https://example.com/csp-report"
```

\*\*report-to наразі вказано як приклад; реальний endpoint буде налаштовано після вибору хостингу з підтримкою CSP-звітності (наприклад, Netlify, Vercel або самостійне логування через endpoint).

- **Додати механізм збору звітів CSP** (через `report-to`) — це дасть змогу моніторити і реагувати на порушення політики.
- **Після тестування** — перейти до повноцінного `Content-Security-Policy` заголовка на продакшені.
- **Усі скрипти та стилі завантажуються лише з `self`**, не використовуються сторонні CDN.
- **Iнлайнові скрипти та стилі відсутні** — використання `unsafe-inline` не потрібно.

➡️ Такий підхід відповідає рекомендаціям [OWASP](https://owasp.org/www-project-secure-headers/#content-security-policy) щодо впровадження CSP та значно зменшує ризик XSS, data injection і небажаного завантаження стороннього контенту.

## 6. Пропозиція заміни: `lodash` ➡️ `@mobily/ts-belt`

При виконнані домашньої №3 з використанням @mobily/ts-belt, прийняла рішення виключили бібліотеку lodash з проекту.
Так як у @mobily/ts-belt є вбудованна функція F.debounce, а для інших цілей бібліотека lodash не використовувалась.

### Порівняння:

| Критерій             | lodash                 | ts-belt                   |
| -------------------- | ---------------------- | ------------------------- |
| Розмір у бандлі      | великий (~24KB)        | малий (~2KB)              |
| Tree-shaking         | частковий              | повний                    |
| Типізація            | слабка                 | повна (TypeScript-native) |
| Історія вразливостей | відомо про вразливості | низький ризик             |
| Підтримка            | Активна                | Активна                   |

### Кроки міграції:

1. Призупинила використання `lodash` (тільки `debounce`)
2. Встановлено `ts-belt` і видалено `lodash` пакет
3. Підчищено типи у package.json `@types/lodash.debounce`
4. Перевірено функціональність — все працює

### Альтернативи `lodash` у TypeScript

**@mobily/ts-belt** - є безпечною, стабільною, з мінімальним розміром бібліотекою і не має відкритих вразливостей.

Проте, зважаючи на несильно активну підтримку `@mobily/ts-belt` додатково розглянула альтернативи.

Нижче наведено порівняльну таблицю сучасних бібліотек, котрі можуть замінити `lodash` у TypeScript-проєктах:

| Бібліотека        | Безпека | Типізація     | Підтримка                   | Розмір  | Особливості                                          |
| ----------------- | ------- | ------------- | --------------------------- | ------- | ---------------------------------------------------- |
| `@mobily/ts-belt` | ✅      | ✅            | ⚠️ Стабільна, але неактивна | ~2 KB   | Потужний функціональний підхід, TS-first             |
| `remeda`          | ✅      | ✅            | ✅ Активна                  | ~3 KB   | Tree-shakable, FP стиль, pipe-орієнтована            |
| `radash`          | ✅      | ✅            | ✅ Дуже активна             | ~5 KB   | Просте API, гарна документація, дружня до розробника |
| `just`            | ✅      | ⚠️ Мінімальна | ⚠️ Рідкі оновлення          | ~0.3 KB | Кожна функція — окремий пакет, точкове використання  |

---

Наразі не бачу необхідності додаткової міграції, але якщо у майбутньому виникне потреба в активнішій підтримці або розширенні функціональності — можна розглянути поступову міграцію на `remeda` або `radash` як **сучасні й безпечні альтернативи**.

## Висновки

- Всі залежності перевірено вручну та автоматичними інструментами
- Виявлені вразливості — усунуті або стосуються лише dev-залежностей
- Замість lodash впроваджено @mobily/ts-belt як безпечнішу і типізовану альтернативу
- Рекомендовано замінити vue-toastification через тривалу відсутність оновлень
- Підготовлено політику Content-Security-Policy у режимі Report-Only — рекомендовано активувати під час деплою
